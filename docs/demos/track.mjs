import { createDemo } from './demo.mjs';
const content = document.getElementsByClassName('page-content')[0];
content.appendChild(createDemo({
  location: globalThis.location,
  version: "0.0.0",
  base: "// Target //\n\nconst { log } = globalThis;\nconst { is, dir, Map: LinvailMap } = globalThis.Linvail;\n\nconst num = 123;\n\nlog(\"\\nProvenancial Equality\");\nlog(is(num, num)); // ✅ true\nlog(is(num, 123)); // ✅ false\n\nlog(\"\\nInspection\");\nlog(num); // 👀 123\ndir(num); // 👀 { inner: 123, index: ... }\n\nlog(\"\\nProvenance Preservation >> Function\");\nconst identity = (/** @type {unknown} */ x) => x;\nlog(is(identity(num), num)); // ✅ true\nlog(is(identity(num), 123)); // ✅ false\n\nlog(\"\\nProvenance Preservation >> Plain Object\");\nconst object = { num };\nlog(is(object.num, num)); // ✅ true\nlog(is(object.num, 123)); // ✅ false\n\nlog(\"\\nProvenance Preservation >> Array\");\nconst array = [num];\nlog(is(array[0], num)); // ✅ true\nlog(is(array[0], 123)); // ✅ false\n\nlog(\"\\nProvenance Preservation >> Builtin\");\nconst copy = array.map(identity);\nlog(is(copy[0], num)); // ✅ true\nlog(is(copy[0], 123)); // ✅ false\n\nPromise.resolve(num).then((res) => {\n  log(\"\\nProvenance Loss >> Promise\");\n  log(is(res, num)); // ❌ false\n});\n\nlog(\"\\nProvenance Loss >> ES6 Collection\");\nconst map1 = new Map([[num, num]]);\nmap1.forEach((val, key) => {\n  log(is(key, num)); // ❌ false\n  log(is(val, num)); // ❌ false\n});\n\nlog(\"\\nProvenance Preservation >> Linvail Collection\");\nconst map2 = new LinvailMap([[num, num]]);\nlog(map2.has(num)); // ✅ true\nlog(map2.has(123)); // ✅ false\nmap2.forEach((val, key) => {\n  log(is(key, num)); // ✅ true\n  log(is(key, 123)); // ✅ false\n  log(is(val, num)); // ✅ true\n  log(is(val, 123)); // ✅ false\n});\n\nlog(\"\\nProvenance Loss >> Partial Instrumentation\");\nglobalThis.eval(`(({ num, object, is, log, dir }) => {\n  log(is(object.num, num)); // ❌ false\n  log(object.num); // 👀 123\n  dir(object.num); // 👀 123\n});`)({ num, object, is, log, dir });\n",
  meta: "// Instrumentation //\n\n/** @type {import(\"../../context.d.ts\").Context} */\nconst {\n  log,\n  target,\n  acorn: { parse },\n  astring: { generate },\n  aran: { compileIntrinsicRecord, transpile, retropile },\n  linvail: { weave, createRuntime },\n} = /** @type {any} */ (globalThis).__context;\n\nconst advice_global_variable = \"__LINVAIL_ADVICE__\";\nconst intrinsic_global_variable = \"__INTRINSIC_RECORD__\";\nlet counter = 0;\n\nconst intrinsics = compileIntrinsicRecord(globalThis);\nconst { advice, library } = createRuntime(intrinsics, {\n  dir: (/** @type {unknown} */ value) => log(JSON.stringify(value)),\n  wrapPrimitive: (inner) => ({ type: \"primitive\", inner, index: counter++ }),\n});\n/** @type {any} */ (globalThis)[intrinsic_global_variable] = intrinsics;\n/** @type {any} */ (globalThis)[advice_global_variable] = advice;\n/** @type {any} */ (globalThis).log = log;\n/** @type {any} */ (globalThis).Linvail = library;\nconst root1 = parse(target, { sourceType: \"script\", ecmaVersion: 2024 });\nconst root2 = transpile({ path: \"main\", kind: \"eval\", root: root1 });\nconst root3 = weave(root2, { advice_global_variable });\nconst root4 = retropile(root3, { intrinsic_global_variable });\nglobalThis.eval(generate(root4));\n",
  worker: './worker.mjs',
  header_class: 'wrapper',
}));
