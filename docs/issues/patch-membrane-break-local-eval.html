<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Patch Membrane Break Local Eval | Aran</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Patch Membrane Break Local Eval" />
<meta name="author" content="Laurent Christophe" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Sometimes dynamically evaluated code must also be instrumented. Either because such code is of interest or because the global-declarative-record option is set to &quot;emulate&quot; (this option requires every bit of code to be instrumented). To control the access of dynamic code evaluation means by the target program, the user can patch the global object. A technique that I name patch membrane. This involved redefining global variables such as Function and eval and even DOM accessors to intercept dynamic addition of script elements. However, by redefining eval, the user will break support local eval calls. Indeed, Aran relies on the variable eval to be assigned to the intrinsic eval value to support direct eval calls. This is hard to overcome because the body on instrumented code is executed in strict mode and cannot re-assign the eval variable." />
<meta property="og:description" content="Sometimes dynamically evaluated code must also be instrumented. Either because such code is of interest or because the global-declarative-record option is set to &quot;emulate&quot; (this option requires every bit of code to be instrumented). To control the access of dynamic code evaluation means by the target program, the user can patch the global object. A technique that I name patch membrane. This involved redefining global variables such as Function and eval and even DOM accessors to intercept dynamic addition of script elements. However, by redefining eval, the user will break support local eval calls. Indeed, Aran relies on the variable eval to be assigned to the intrinsic eval value to support direct eval calls. This is hard to overcome because the body on instrumented code is executed in strict mode and cannot re-assign the eval variable." />
<link rel="canonical" href="https://lachrist.github.io/aran/issues/patch-membrane-break-local-eval" />
<meta property="og:url" content="https://lachrist.github.io/aran/issues/patch-membrane-break-local-eval" />
<meta property="og:site_name" content="Aran" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-05-23T15:15:04+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Patch Membrane Break Local Eval" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Laurent Christophe"},"dateModified":"2025-05-23T15:15:04+02:00","datePublished":"2025-05-23T15:15:04+02:00","description":"Sometimes dynamically evaluated code must also be instrumented. Either because such code is of interest or because the global-declarative-record option is set to &quot;emulate&quot; (this option requires every bit of code to be instrumented). To control the access of dynamic code evaluation means by the target program, the user can patch the global object. A technique that I name patch membrane. This involved redefining global variables such as Function and eval and even DOM accessors to intercept dynamic addition of script elements. However, by redefining eval, the user will break support local eval calls. Indeed, Aran relies on the variable eval to be assigned to the intrinsic eval value to support direct eval calls. This is hard to overcome because the body on instrumented code is executed in strict mode and cannot re-assign the eval variable.","headline":"Patch Membrane Break Local Eval","mainEntityOfPage":{"@type":"WebPage","@id":"https://lachrist.github.io/aran/issues/patch-membrane-break-local-eval"},"url":"https://lachrist.github.io/aran/issues/patch-membrane-break-local-eval"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/aran/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://lachrist.github.io/aran/feed.xml" title="Aran" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/aran/">Aran</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/aran/start.html">Quick Start</a><a class="page-link" href="/aran/api.html">API</a><a class="page-link" href="/aran/typedoc.html">TypeDoc</a><a class="page-link" href="/aran/issues.html">Issues</a><a class="page-link" href="/aran/demo.html">Live Demo</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <h1>Patch Membrane Break Local Eval</h1>
        <p>Sometimes dynamically evaluated code must also be instrumented. Either because such code is of interest or because the <code class="language-plaintext highlighter-rouge">global-declarative-record</code> option is set to <code class="language-plaintext highlighter-rouge">"emulate"</code> (this option requires every bit of code to be instrumented). To control the access of dynamic code evaluation means by the target program, the user can patch the global object. A technique that I name <em>patch membrane</em>. This involved redefining global variables such as <code class="language-plaintext highlighter-rouge">Function</code> and <code class="language-plaintext highlighter-rouge">eval</code> and even DOM accessors to intercept dynamic addition of <code class="language-plaintext highlighter-rouge">script</code> elements. However, by redefining <code class="language-plaintext highlighter-rouge">eval</code>, the user will break support local eval calls. Indeed, Aran relies on the variable <code class="language-plaintext highlighter-rouge">eval</code> to be assigned to the intrinsic <code class="language-plaintext highlighter-rouge">eval</code> value to support direct eval calls. This is hard to overcome because the body on instrumented code is executed in strict mode and cannot re-assign the <code class="language-plaintext highlighter-rouge">eval</code> variable.</p>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/aran/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Aran</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Laurent Christophe</li><li><a class="u-email" href="mailto:laurent.christophe.terken@gmail.com">laurent.christophe.terken@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/lachrist"><svg class="svg-icon"><use xlink:href="/aran/assets/minima-social-icons.svg#github"></use></svg> <span class="username">lachrist</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Documentation for Aran, a JavaScript Instrumentation Library</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
